unit Unit3;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Grids;

type
  TForm3 = class(TForm)
    Строки: TLabel;
    Столбцы: TLabel;
    Label3: TLabel;
    Вывод: TLabel;
    Label2: TLabel;
    Label1: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    SG1: TStringGrid;
    Edit1: TEdit;
    Button1: TButton;
    Edit2: TEdit;
    Edit3: TEdit;
    Edit4: TEdit;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormCreate(Sender: TObject);
    procedure Edit1Change(Sender: TObject);
    procedure Edit2Change(Sender: TObject);
    procedure Edit3Change(Sender: TObject);
    procedure Edit4Change(Sender: TObject);
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form3: TForm3;

implementation
Uses Unit2;
{$R *.dfm}

procedure TForm3.Button1Click(Sender: TObject);
begin
  int S, P, O;
	if (Edit3->Text == "" || Edit3->Text == "-")
	{
		Edit3->Text = "0"; a=0;
	}
	if (Edit4->Text == "" || Edit4->Text == "-")
	{
		Edit4->Text = "0"; b=0;
	}
	if (b < a) Label2->Caption="Ошибка, 'B' должно быть больше или равно 'A'!";
	else
	{
		P = 0; O = 0;
		for (int j = 1; j < SG1->ColCount; j++)
		{
			S = 0;
			for (int i = 1; i < SG1->RowCount; i++)
			{
				if (SG1->Cells[j][i] == "" || SG1->Cells[j][i] == "-")
					SG1->Cells[j][i] = 0;
				S += StrToInt(SG1->Cells[j][i]);
				if (SG1->Cells[j][i]>0) P+=1;
				else O+=1;
			}
			if (S >= a && S <= b)
			{
				stolb.push_back(j);
			}
		}
		if (stolb.empty())
			Label2->Caption="Нет столбцов, сумма элементов в которых\nнаходится в заданном диапозоне.";
		else
		{
			Label2->Caption="В " + IntToStr(stolb[0]);
			for (int i = 1; i<stolb.size(); i++)
			{
				Label2->Caption = Label2->Caption + " ," + IntToStr(stolb[i]);
			}
			if (stolb.size() == 1) Label2->Caption = Label2->Caption + " столбце";
			else Label2->Caption = Label2->Caption + " столбцах";
			Label2->Caption = Label2->Caption + "\nсумма элементов находится в заданном диапозоне.";
		}
		stolb.clear();
		if (Form3->CB1->Checked)
		{
		for (int j = 1; j < SG1->ColCount; j++)
			for (int i = 1; i < SG1->RowCount; i++)
				if (SG1->Cells[j][i]>0) P+=1;
				else O+=1;
			if (P>O) Label2->Caption = Label2->Caption + "\nВ заданом массиве больше половины положительных элементов.";
			else Label2->Caption = Label2->Caption + "\nВ заданом массиве не больше половины положительных элементов.";
		}
	}
end;

procedure TForm3.Edit1Change(Sender: TObject);
begin
  int n;
	if (Edit1->Text == "0")
		Edit1->Text = "1";
	if (Edit1->Text != "")
	{
		n = StrToInt(Edit1->Text);
		SG1->RowCount = n + 1;
		for (int i = 1; i < SG1->RowCount; i++)
			SG1->Cells[0][i] = i;
	}
end;

procedure TForm3.Edit2Change(Sender: TObject);
begin
  int n;
	if (Edit2->Text == "0")
		Edit2->Text = "1";
	if (Edit2->Text != "")
	{
		n = StrToInt(Edit2->Text);
		SG1->ColCount = n + 1;
		for (int i = 1; i < SG1->ColCount; i++)
			SG1->Cells[i][0] = i;
	}
end;

procedure TForm3.Edit3Change(Sender: TObject);
begin
  if (Edit3->Text != "" && Edit3->Text != "-")
		a = StrToInt(Edit3->Text);
end;

procedure TForm3.Edit4Change(Sender: TObject);
begin
  if (Edit4->Text != "" && Edit4->Text != "-")
		b = StrToInt(Edit4->Text);
end;

procedure TForm3.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  Form2.Processing1.enabled:=true;
  action:=cafree;
end;

procedure TForm3.FormCreate(Sender: TObject);
var
  n, i:integer;
begin
  Form3.Label1.Caption := 'Массив состоит из целых чисел. Определить номера столбцов,\nсумма элементов в которых находится в заданном диапозоне [a,b].\nВыполнить выбранные дополнительные задачи.';
	n := 2;
	SG1.ColCount := n + 1;
	for i:=1 to SG1.ColCount do
		SG1.Cells[i, 0] := IntToStr(i);
	SG1.RowCount := n + 1;
	for i:=1 to SG1.RowCount do
    SG1.Cells[0, i] := IntToStr(i);
end;

end.
